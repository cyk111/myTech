### 凭证

- Credentials 凭证
-  承载认证授权信息
- 两张承载方式，在客户端承载；在服务器端承载

#### 凭证的两种方式
- Cookie-Session 方式
- JWT方式


### Cookie-Session 方式
- http协议无状态，状态信息存储于服务器上
- client端 请求 header 定义字段 cookie(sessionid jsessionid),根据key值，在服务器内存中查找授权的功功能
- 依赖基础，[[同源策略]] 和[[HTTPS]]传输层安全,保证cookie的键值不被窃取
- 使用场景：单节点的单体环境中最合适的方案
- 水平扩展时候
	- 牺牲集群一致性(Consistency)，负载均衡器采用亲和式的负载均衡算法 如根据用户ip或者session来分配节点，，每个请求都会分配到其中某一个节点来提供服务，如果节点崩溃，用户状态便完全丢失
	- 牺牲集群可用性（Availablity） 各个节点采用session复制，每个节点的session变动都会发送到其他服务器上，这样某个节点崩溃，其他节点不用中断某个用户服务，但是Session直接复制成本高，节点越多，成本越高
	- 牺牲分区容忍性（partition tolerance）数据中心节点存储，一旦数据节点损坏，整个集群不能提供服务
- CAP 不可兼得，状态管理一定会受CAP的局限，无论怎样都不可能完美


### JWT（json  web token）
- 状态信息存储在客户端，，但是无法携带大量数据，而且有泄露和篡改的安全风险，所以有了jwt的方案
- 准确、完整、不可篡改、不可抵赖
- 组成
	- 令牌头(header)
	- 负载(payload)
	- 签名(Signature)
- 缺点
	- 令牌难以主动失效，一点签发与服务器没有关系，通过不同设备都可以操作
	- 相对更容易遭受重放攻击
	- 只能携带相当有限的数据，http协议没有header长度约束，服务器、浏览器都有约束，tomcat header最大不超过8KB，nginx中则默认4KB
	- 必须考虑客令牌在客户端如何存储